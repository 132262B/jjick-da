<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="app.jjickda.api.admin.repository.AdminRepository">

    <insert id="registMain">
        INSERT
          INTO exam_main_category
             ( main_ctg_name
             , use_status
             , reg_date
             , reg_seq
             )
        VALUES
             ( #{main_question.main_ctg_name}
             , 1
             , now()
             , 0
             );
    </insert>

    <insert id="registSub">
        INSERT INTO exam_sub_category(
            main_ctg_seq,
            sub_ctg_name,
            use_status,
            reg_date,
            reg_seq
        )VALUES(
            #{sub_question.main_ctg_seq},
            #{sub_question.sub_ctg_name},
            1,
            now(),
            0
        );
    </insert>


    <select id="getMainList" resultType="app.jjickda.api.admin.dto.MainQuestionDto">
        SELECT
        e.main_ctg_seq,
        e.main_ctg_name,
        e.use_status,
        e.reg_date,
        e.reg_seq,
        e.udt_date,
        e.udt_seq,
        u.user_name as reg_user_name,
        IFNULL(user.user_name,"없음") as udt_user_name
        FROM exam_main_category e
        LEFT JOIN user u
        ON reg_seq = u.user_seq
        LEFT JOIN user user
        ON udt_seq = user.user_seq;
    </select>

    <select id="getSubList" resultType="app.jjickda.api.admin.dto.SubQuestionDto">
        select
        e.sub_ctg_seq,
        e.sub_ctg_name,
        e.use_status,
        e.reg_date,
        e.reg_seq,
        e.udt_date,
        e.udt_seq,
        u.user_name as reg_user_name,
        IFNULL(user.user_name,"없음") as udt_user_name
        FROM exam_sub_category e
        LEFT JOIN user u
        ON reg_seq = u.user_seq
        LEFT JOIN user user
        ON udt_seq = user.user_seq;
    </select>



</mapper>